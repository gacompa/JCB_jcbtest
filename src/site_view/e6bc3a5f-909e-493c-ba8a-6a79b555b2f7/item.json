{
    "system_name": "Map",
    "name": "Map",
    "description": "Map of locations",
    "main_get": "90cb8f6b-8960-48f4-9536-7a30b0467117",
    "add_php_jview_display": 1,
    "add_php_document": 1,
    "add_php_view": 1,
    "js_document": "",
    "codename": "map",
    "javascript_file": "",
    "context": "map",
    "default": "<style>\r\n    #map-container {\r\n        height: 800px;\r\n        width: 100%;\r\n        border-radius: 8px;\r\n        box-shadow: 0 4px 6px rgba(0,0,0,0.1);\r\n        margin-top: 20px;\r\n    }\r\n<\/style>\r\n\r\n<div id=\"map-container\"><\/div>\r\n\r\n<script>\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    \/\/ Check if Leaflet is loaded\r\n    if (typeof L === 'undefined') {\r\n        console.error(\"Leaflet library not loaded.\");\r\n        return;\r\n    }\r\n\r\n    const map = L.map('map-container').setView([20, 0], 2); \/\/ A general view of the world\r\n\r\n    L.tileLayer('https:\/\/{s}.tile.openstreetmap.org\/{z}\/{x}\/{y}.png', {\r\n        attribution: '&copy; <a href=\"https:\/\/www.openstreetmap.org\/copyright\">OpenStreetMap<\/a> contributors'\r\n    }).addTo(map);\r\n\r\n    \/\/ Get the locations from PHP and parse them into a JavaScript object.\r\n    const places = <?php echo json_encode($this->items); ?>;\r\n    const markers = [];\r\n\r\n    places.forEach(function(place) {\r\n        \/\/ Ensure latitude and longitude are valid numbers\r\n        const lat = parseFloat(place.latitude);\r\n        const lng = parseFloat(place.longitude);\r\n\r\n        if (!isNaN(lat) && !isNaN(lng)) {\r\n            const marker = L.marker([lat, lng]).addTo(map);\r\n            marker.bindPopup(`<b>${place.place}<\/b><br>${place.is_stop}`);\r\n            markers.push(marker);\r\n        }\r\n    });\r\n\r\n    if (markers.length > 0) {\r\n        \/\/ Fit the map view to show all markers\r\n        const group = new L.featureGroup(markers);\r\n        map.fitBounds(group.getBounds().pad(0.5));\r\n    }\r\n});\r\n<\/script>",
    "snippet": "0",
    "add_php_jview": 1,
    "custom_get": null,
    "css_document": "",
    "add_javascript_file": 0,
    "css": "",
    "add_js_document": 0,
    "php_ajaxmethod": "\/\/CUSTOMCODE site view  Add PHP (AJAX) * ",
    "add_css_document": 0,
    "libraries": null,
    "add_css": 0,
    "dynamic_get": "90cb8f6b-8960-48f4-9536-7a30b0467117",
    "add_php_ajax": 1,
    "ajax_input": null,
    "add_custom_button": 0,
    "php_document": "\/\/CUSTOMCODE site view  Add PHP (custom document script) * ",
    "button_position": 2,
    "php_view": "\/\/CUSTOMCODE site view  Add PHP (custom view script) * \r\nuse Joomla\\CMS\\HTML\\HTMLHelper;\r\n\/\/ Load Leaflet CSS and JS from a CDN\r\nHTMLHelper::_('stylesheet', 'https:\/\/unpkg.com\/leaflet@1.7.1\/dist\/leaflet.css');\r\nHTMLHelper::_('script', 'https:\/\/unpkg.com\/leaflet@1.7.1\/dist\/leaflet.js', ['version' => 'auto', 'relative' => false]);\r\n",
    "php_jview_display": "\/\/CUSTOMCODE site view  Add PHP (custom HtmlView display) * ",
    "custom_button": null,
    "php_jview": "\/\/CUSTOMCODE site view  Add PHP (custom HtmlView methods) * ",
    "php_controller": "",
    "guid": "e6bc3a5f-909e-493c-ba8a-6a79b555b2f7",
    "php_model": "",
    "@dependencies": [
        {
            "key": "guid",
            "value": "90cb8f6b-8960-48f4-9536-7a30b0467117",
            "entity": "dynamic_get",
            "table": "#__componentbuilder_dynamic_get",
            "direction": "out"
        }
    ]
}