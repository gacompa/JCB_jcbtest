{
    "system_name": "Locations map",
    "name": "Location map",
    "description": "Map of locations",
    "main_get": "20b712a5-9e9f-4f68-8589-3d02df7fe142",
    "add_php_jview_display": 0,
    "add_php_document": 0,
    "add_php_view": 1,
    "js_document": "",
    "codename": "locations_map",
    "javascript_file": "",
    "context": "locations",
    "default": "<style>\r\n    #map-container {\r\n        height: 800px;\r\n        width: 100%;\r\n        border-radius: 8px;\r\n        box-shadow: 0 4px 6px rgba(0,0,0,0.1);\r\n        margin-top: 20px;\r\n    }\r\n<\/style>\r\n\r\n<div id=\"map-container\"><\/div>\r\n\r\n<script>\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    \/\/ Check if Leaflet is loaded\r\n    if (typeof L === 'undefined') {\r\n        console.error(\"Leaflet library not loaded.\");\r\n        return;\r\n    }\r\n\r\n    const map = L.map('map-container').setView([20, 0], 2); \/\/ A general view of the world\r\n\r\n    L.tileLayer('https:\/\/{s}.tile.openstreetmap.org\/{z}\/{x}\/{y}.png', {\r\n        attribution: '&copy; <a href=\"https:\/\/www.openstreetmap.org\/copyright\">OpenStreetMap<\/a> contributors'\r\n    }).addTo(map);\r\n    \/\/ Aggiungi il layer con curve di livello\r\n    var topoLayer = L.tileLayer('https:\/\/{s}.tile.opentopomap.org\/{z}\/{x}\/{y}.png', {\r\n        maxZoom: 17,\r\n        attribution: 'Map data: &copy; OpenStreetMap contributors, SRTM | Map style: &copy; OpenTopoMap (CC-BY-SA)'\r\n    }).addTo(map);\r\n\r\n    \/\/ Get the locations from PHP and parse them into a JavaScript object.\r\n    const places = <?php echo json_encode($this->items); ?>;\r\n    const markers = [];\r\n\r\n    places.forEach(function(place) {\r\n        \/\/ Ensure latitude and longitude are valid numbers\r\n        const lat = parseFloat(place.latitude);\r\n        const lng = parseFloat(place.longitude);\r\n\r\n        if (!isNaN(lat) && !isNaN(lng)) {\r\n        const markerOptions = {\r\n            radius: 10,           \/\/ Increased size for visibility\r\n            fillColor: \"#ff0000\",   \/\/ Red color\r\n            color: \"#ffffff\",   \/\/ Outline color (white creates a \"halo\" effect)\r\n            weight: 2,            \/\/ Thickness of the outline\r\n            opacity: 1,           \/\/ Opacity of the outline\r\n            fillOpacity: 0.9,     \/\/ Makes the color more solid\r\n            pane: 'markerPane',   \/\/ Ensures markers stay above the map layers\r\n            interactive: true,    \/\/ Set to false if you want the marker to be \"ghost\"\r\n            className: 'pulsing-marker' \/\/ Add a CSS class for animations            radius: 8,\r\n        };\r\n        const marker = L.circleMarker([lat, lng], markerOptions).addTo(map);\r\n\r\n        \/\/ Use bindTooltip for \"hover\" behavior\r\n        \/\/ 'sticky: true' makes the tooltip follow the mouse cursor\r\n        marker.bindTooltip(`<b>${place.name}<\/b><br>${place.description}`, {\r\n            permanent: false, \r\n            direction: 'top',\r\n            sticky: true,\r\n            className: 'custom-tooltip' \/\/ Optional: for custom CSS\r\n            }\r\n        );\r\n        \/\/ You can still keep bindPopup for \"click\" behavior if you want both\r\n        marker.bindPopup(`<b>${place.name}<\/b><br>${place.description}`);\r\n        markers.push(marker);\r\n        }\r\n        }\r\n    );\r\n\r\n\r\n    if (markers.length > 0) {\r\n        \/\/ Fit the map view to show all markers\r\n        const group = new L.featureGroup(markers);\r\n        map.fitBounds(group.getBounds().pad(0.5));\r\n    }\r\n});\r\n<\/script>\r\n",
    "snippet": "0",
    "add_php_jview": 0,
    "custom_get": null,
    "css_document": "",
    "add_javascript_file": 0,
    "css": "",
    "add_js_document": 0,
    "php_ajaxmethod": "",
    "add_css_document": 0,
    "libraries": null,
    "add_css": 0,
    "dynamic_get": "e12b2a0d-b122-4bd4-a6b5-29fe926ecf8c",
    "add_php_ajax": 0,
    "ajax_input": null,
    "add_custom_button": 0,
    "php_document": "",
    "button_position": 2,
    "php_view": "\/\/CUSTOMCODE site view  Add PHP (custom view script) * \r\nuse Joomla\\CMS\\HTML\\HTMLHelper;\r\n\/\/ Load Leaflet CSS and JS from a CDN\r\nHTMLHelper::_('stylesheet', 'https:\/\/unpkg.com\/leaflet@1.7.1\/dist\/leaflet.css');\r\nHTMLHelper::_('script', 'https:\/\/unpkg.com\/leaflet@1.7.1\/dist\/leaflet.js', ['version' => 'auto', 'relative' => false]);\r\n",
    "php_jview_display": "",
    "custom_button": null,
    "php_jview": "",
    "php_controller": "",
    "guid": "7d637624-7dd1-4f4e-a7aa-cfc7d333ded0",
    "php_model": "",
    "@dependencies": [
        {
            "key": "guid",
            "value": "20b712a5-9e9f-4f68-8589-3d02df7fe142",
            "entity": "dynamic_get",
            "table": "#__componentbuilder_dynamic_get",
            "direction": "out"
        },
        {
            "key": "guid",
            "value": "e12b2a0d-b122-4bd4-a6b5-29fe926ecf8c",
            "entity": "dynamic_get",
            "table": "#__componentbuilder_dynamic_get",
            "direction": "out"
        }
    ]
}